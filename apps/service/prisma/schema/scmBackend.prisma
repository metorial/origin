enum ScmBackendType {
  github
  github_enterprise
}

model ScmBackend {
  oid BigInt @id @default(autoincrement())
  id  String @unique

  type ScmBackendType

  // Display information
  name        String
  description String?

  // API endpoints
  apiUrl String // e.g., "https://api.github.com" or "https://github.company.com/api/v3"
  webUrl String // e.g., "https://github.com" or "https://github.company.com"

  // GitHub App credentials (for GitHub and GitHub Enterprise)
  appId         String?
  appPrivateKey String?
  clientId      String?
  clientSecret  String?

  // Tenant-specific or global
  tenantOid BigInt?
  tenant    Tenant? @relation(fields: [tenantOid], references: [oid], onDelete: Cascade)

  isDefault Boolean @default(false) // System-managed default backends (like github.com)

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  installations        ScmInstallation[]
  installationAttempts ScmInstallationAttempt[]

  @@unique([tenantOid, type, apiUrl])
}
